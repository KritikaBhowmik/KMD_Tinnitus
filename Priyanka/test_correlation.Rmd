---
title: "PCA"
author: "Priyanka"
date: "26 Mai 2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r}
library(sqldf)
library(dplyr)
#correlation
test <- select(df,-c(.jour_nr))
test2 <- data.frame(F1 = character(),F2 = character(),coef = numeric())


cat("\ncorrelation with 90%:\n")
matriz_cor <- cor(test,method = "spearman")

   for (i in 1:nrow(matriz_cor)){
     correlations <-  which((abs(matriz_cor[i,]) > 0.9) & (matriz_cor[i,] != 1))
     matriz_cor[correlations,i] <- NA
     
     if(length(correlations)> 0){
       lapply(correlations,FUN =  function(x) (cat("\t",paste(colnames(test)[i], "with",colnames(test)[x]), "\n")))
       test2 <-  rbind(test2,data.frame(F1=colnames(test)[i],F2=colnames(test)[correlations],coef=matriz_cor[i,correlations]))
       rownames(test2) <- NULL
     }
   }


test2 <- sqldf("Select F1,F2,coef FROM test2 ORDER BY coef DESC")
test2 <- sqldf("Select F1,F2,coef FROM test2 GROUP BY F2")

test <- select(test,-c(test2$F1))


```

## Including Plots

You can also embed plots, for example:

```{r}
#subspace clustering
library(orclus)
library(subspace)
library(ggvis)

subspace_data <- final_data_scaled


k.max <- 12

wss <- sapply(1:k.max, 
              function(k){kmeans(subspace_data, k, nstart=50,iter.max = 15 )$tot.withinss})
#wss
plot(1:k.max, wss,
     type="b", pch = 19, frame = FALSE, 
     xlab="Number of clusters K",
     ylab="Total within-clusters sum of squares")

orclus.res <- orclus(x = subspace_data,k = 4,l = 75,10,a = 0.5)
plot(subspace_data,col = orclus.res$cluster)

plot


```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
